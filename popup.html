<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="popup.css">
</head>
<body>
    <div class="header">
        <h1>VPN TOTP Helper</h1>
    </div>
    
    <button class="toggle-btn" id="toggle-settings">Show Settings</button>
    
    <div class="settings-section hidden" id="settings-section">
        <div class="settings-title">Configuration</div>
        <div class="warning" style="margin-bottom: 15px;">
            TOTP Secret and Password are required for the extension to work
        </div>
        <div class="input-group">
            <label class="input-label" for="totp-secret">TOTP Secret Key:</label>
            <input type="text" id="totp-secret" class="input-field" placeholder="Enter your TOTP secret (Base32)" required>
            <div style="display: flex; gap: 10px; margin-top: 8px;">
                <button type="button" class="format-btn" id="scan-qr-upload">
                    ðŸ“¤ Upload QR Code
                </button>
                <button type="button" class="format-btn" id="scan-qr-camera">
                    ðŸ“· Scan with Camera
                </button>
            </div>
            <input type="file" id="qr-file-input" accept="image/*" style="display: none;">
            <div class="warning">Get this from your authenticator app's manual setup or scan QR code</div>
        </div>
        <div class="input-group">
            <label class="input-label" for="time-offset">Time Offset (seconds):</label>
            <input type="number" id="time-offset" class="input-field" placeholder="0" value="0">
            <div class="warning">Adjust if TOTP doesn't match your phone (usually 0)</div>
        </div>
        <div class="input-group">
            <label class="input-label" for="password">Password:</label>
            <input type="password" id="password" class="input-field" placeholder="Enter your VPN password" required>
        </div>
        <div class="input-group">
            <label class="input-label">Copy Format:</label>
            <div style="display: flex; gap: 10px; margin-top: 5px;">
                <button type="button" class="format-btn active" id="totp-first" data-format="totp-first">
                    TOTP + Password
                </button>
                <button type="button" class="format-btn" id="password-first" data-format="password-first">
                    Password + TOTP
                </button>
            </div>
            <div class="warning">Choose the order for copying credentials</div>
        </div>
        <button class="save-btn" id="save-settings">Save Settings</button>
        <div class="warning">Settings are stored locally and never shared</div>
    </div>
    
    <div class="main-section">
        <div class="section-title">
            <span class="icon"></span>
            TOTP Generator
        </div>
        <div class="credential-row">
            <span class="credential-label">Current TOTP:</span>
            <span class="credential-value" id="current-totp">------</span>
        </div>
        <button class="copy-btn" id="copy-auth" disabled>Copy TOTP+Password</button>
    </div>
    
    <div class="totp-timer">
        TOTP expires in: <span class="totp-countdown" id="countdown">--</span>s
    </div>
    
    <div class="footer">
        Auto-refreshes every 30 seconds
    </div>
    
    <!-- Camera scanner modal -->
    <div id="camera-modal" class="camera-modal hidden">
        <div class="camera-container">
            <div class="camera-header">
                <span>Scan QR Code</span>
                <button id="close-camera" class="close-btn">âœ•</button>
            </div>
            <video id="camera-preview" autoplay playsinline></video>
            <canvas id="qr-canvas" style="display: none;"></canvas>
            <div class="camera-status" id="camera-status">Position QR code in view</div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js"></script>
    <script src="popup.js"></script>
</body>
</html>
